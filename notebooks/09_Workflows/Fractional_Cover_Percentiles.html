


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Fractional Cover Percentiles &mdash; Digital Earth Australia 1.0.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/dea-favicon.ico"/>
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="https://unpkg.com/font-awesome@4.5.0/css/font-awesome.min.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Scripts" href="../10_Scripts/README.html" />
    <link rel="prev" title="Fractional Cover: Trend and Variability Analysis" href="Fractional_Cover_Change_Detection.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/dea-logo-inline.svg" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/changelog.html">DEA NCI Environment Changelog</a></li>
</ul>
<p class="caption"><span class="caption-text">Connect</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../connect/account.html">NCI Account Registration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../connect/install.html">Installation and Software Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../connect/nci_basics.html">Command Line Usage (Advanced)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../connect/jupyter.html">Jupyter Notebooks Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../internal/other_modules.html">Other Modules</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../01_Getting_started/README.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_DEA_datasets/README.html">DEA Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_Integrating_external_data/README.html">Integrating External Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04_Index_calculation/README.html">Index Calculation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_Temporal_analysis/README.html">Temporal Analyses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../06_Composite_generation/README.html">Composite Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../07_Image_classification/README.html">Image Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../08_Outputting_data/README.html">Outputting data</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="README.html">Workflows</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="RetrieveLandsat8ViewAndExport.html">View Landsat 8 imagery for a chosen time period</a></li>
<li class="toctree-l2"><a class="reference internal" href="Sun_glint_identification_and_removal.html">Sun glint identification and removal</a></li>
<li class="toctree-l2"><a class="reference internal" href="Fractional_Cover_Change_Detection.html">Fractional Cover: Trend and Variability Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="Fractional_Cover_Change_Detection.html#Pixel-wise-trend-and-variability-analysis">Pixel-wise trend and variability analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="Fractional_Cover_Change_Detection.html#Zonal-Statistics">Zonal Statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="Fractional_Cover_Change_Detection.html#Reporting-and-plotting">Reporting and plotting</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Fractional Cover Percentiles</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Import-modules-from-standard-libraries,-datacube-and-files">Import modules from standard libraries, datacube and files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Specify-the-query-with-the-coordinates-and-date-range">Specify the <em>query</em> with the coordinates and date range</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#load-the-data-according-to-our-query">load the data according to our query</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Plot-Fractional-Cover-and-Unmixing-Error-Bands">Plot Fractional Cover and Unmixing Error Bands</a></li>
<li class="toctree-l4"><a class="reference internal" href="#load-the-wofs-feature-layers-(wofls)-within-the-same-query-as-Fractional-cover,-using-'like'">load the wofs feature layers (wofls) within the same query as Fractional cover, using ‘like’</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Remove-areas-of-water-from-the-Fractional-Cover-dataset">Remove areas of water from the Fractional Cover dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Calculate-percentiles-of-Fractional-Cover">Calculate percentiles of Fractional Cover</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Specify-percentiles-to-calculate">Specify percentiles to calculate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Calculate-percentiles">Calculate percentiles</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#create-Percentile-object">create Percentile object</a></li>
<li class="toctree-l4"><a class="reference internal" href="#compute-percentiles">compute percentiles</a></li>
<li class="toctree-l4"><a class="reference internal" href="#reattach-attributes">reattach attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Plot-percentiles">Plot percentiles</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Edit-save-file-path-to-choose-where-to-save-your-output-files">Edit save file path to choose where to save your output files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Save-Fractional-Cover-percentiles-to-NetCDF">Save Fractional Cover percentiles to NetCDF</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="##Write-out-percentiles-to-NetCDF">#Write out percentiles to NetCDF</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Save-Fractional-Cover-percentiles-to-GeoTiff">Save Fractional Cover percentiles to GeoTiff</a></li>
<li class="toctree-l3"><a class="reference internal" href="#References">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../10_Scripts/README.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Supplementary_data/README.html">Supplementary Data</a></li>
</ul>
<p class="caption"><span class="caption-text">Data Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../data/data.html">Surface Reflectance</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../internal/new_product.html">Creating a New Product</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../internal/git_best_practice.html">Git Best Practice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../internal/release.html">DEA Release Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../internal/modules.html">DEA Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../internal/collection_management.html">Collection Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../internal/requirements_met.html">DEA Code Functionality Examples</a></li>
</ul>
<p class="caption"><span class="caption-text">Indexes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../genindex.html">Tags Index</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Digital Earth Australia</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="README.html">Workflows</a> &raquo;</li>
        
      <li>Fractional Cover Percentiles</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/notebooks/09_Workflows/Fractional_Cover_Percentiles.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="Fractional-Cover-Percentiles">
<h1>Fractional Cover Percentiles<a class="headerlink" href="#Fractional-Cover-Percentiles" title="Permalink to this headline">¶</a></h1>
<p><strong>Background:</strong> <a class="reference external" href="https://d28rz98at9flks.cloudfront.net/79676/Fractional_Cover_FC25_v1_5.PDF">Fractional
Cover</a>
(FC25) data is stored in DEA. More information on <em>Fractional Cover</em> can
be found in the <em>‘Introduction to Fractional Cover’</em> notebook.</p>
<p><strong>What does this notebook do?:</strong> This notebook demonstrates using
Fractional Cover Percentiles (calculated using datacube stats).The data
is then saved to NetCDF and GeoTIFF for analysis elsewhere.</p>
<p><strong>Tags:</strong> <span class="target" id="index-0"></span>Landsats 5,7,8, <span class="target" id="index-1"></span>products, <span class="target" id="index-2"></span>Fractional Cover, <span class="target" id="index-3"></span>dc.list_products, <span class="target" id="index-4"></span>dc.load, <span class="target" id="index-5"></span>query, <span class="target" id="index-6"></span>plot, <span class="target" id="index-7"></span>image, <span class="target" id="index-8"></span>Plot Multiple Images, <span class="target" id="index-9"></span>quantiles, <span class="target" id="index-10"></span>WOFLs, <span class="target" id="index-11"></span>WOfS, <span class="target" id="index-12"></span>WOfS filtration, <span class="target" id="index-13"></span>NetCDF,:index:<cite>GeoTIFF</cite>,:index:<cite>datacube-stats</cite>, <span class="target" id="index-14"></span>Percentile</p>
<div class="section" id="Import-modules-from-standard-libraries,-datacube-and-files">
<h2>Import modules from standard libraries, datacube and files<a class="headerlink" href="#Import-modules-from-standard-libraries,-datacube-and-files" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">matplotlib.gridspec</span> <span class="k">as</span> <span class="nn">gridspec</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="c1">#modules for datacube</span>
<span class="kn">import</span> <span class="nn">datacube</span>
<span class="kn">from</span> <span class="nn">datacube.storage</span> <span class="k">import</span> <span class="n">masking</span>
<span class="kn">from</span> <span class="nn">datacube.storage.storage</span> <span class="k">import</span> <span class="n">write_dataset_to_netcdf</span>
<span class="kn">from</span> <span class="nn">datacube_stats.statistics</span> <span class="k">import</span> <span class="n">Percentile</span>
<span class="kn">from</span> <span class="nn">datacube.helpers</span> <span class="k">import</span> <span class="n">ga_pq_fuser</span><span class="p">,</span> <span class="n">write_geotiff</span>
<span class="kn">from</span> <span class="nn">digitalearthau.utils</span> <span class="k">import</span> <span class="n">wofs_fuser</span> <span class="c1">## this is the group_by for wofs!</span>
<span class="c1"># Import external functions from dea-notebooks --note Scripts directory has moved recently</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~/dea-notebooks/Scripts/&#39;</span><span class="p">))</span>
<span class="kn">import</span> <span class="nn">DEAPlotting</span><span class="o">,</span> <span class="nn">DEADataHandling</span>

<span class="c1">#ignore datacube warnings (needs to be last import statement)</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">module</span><span class="o">=</span><span class="s1">&#39;datacube&#39;</span><span class="p">)</span>

<span class="c1"># set datacube alias (just a string with what you&#39;re doing)</span>
<span class="n">dc</span> <span class="o">=</span> <span class="n">datacube</span><span class="o">.</span><span class="n">Datacube</span><span class="p">(</span><span class="n">app</span><span class="o">=</span><span class="s1">&#39;dc-FC&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ModuleNotFoundError</span>                       Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-1-59b8d8affbc4&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">     16</span> <span class="ansi-red-fg"># Import external functions from dea-notebooks --note Scripts directory has moved recently</span>
<span class="ansi-green-intense-fg ansi-bold">     17</span> sys<span class="ansi-blue-fg">.</span>path<span class="ansi-blue-fg">.</span>append<span class="ansi-blue-fg">(</span>os<span class="ansi-blue-fg">.</span>path<span class="ansi-blue-fg">.</span>expanduser<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;~/dea-notebooks/Scripts/&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 18</span><span class="ansi-red-fg"> </span><span class="ansi-green-fg">import</span> DEAPlotting<span class="ansi-blue-fg">,</span> DEADataHandling
<span class="ansi-green-intense-fg ansi-bold">     19</span>
<span class="ansi-green-intense-fg ansi-bold">     20</span> <span class="ansi-red-fg">#ignore datacube warnings (needs to be last import statement)</span>

<span class="ansi-red-fg">ModuleNotFoundError</span>: No module named &#39;DEAPlotting&#39;
</pre></div></div>
</div>
<div class="section" id="Specify-the-query-with-the-coordinates-and-date-range">
<h3>Specify the <em>query</em> with the coordinates and date range<a class="headerlink" href="#Specify-the-query-with-the-coordinates-and-date-range" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#the query is a dictionary where the keys are the spatio-temporal specs</span>
<span class="n">query</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">35.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">35.35</span><span class="p">),</span>
        <span class="s1">&#39;lon&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">149.05</span><span class="p">,</span> <span class="mf">149.17</span><span class="p">),</span>
        <span class="s1">&#39;time&#39;</span><span class="p">:(</span><span class="s1">&#39;2015-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2017-01-31&#39;</span><span class="p">)</span>
        <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="load-the-data-according-to-our-query">
<h2>load the data according to our query<a class="headerlink" href="#load-the-data-according-to-our-query" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">DEADataHandling</span><span class="o">.</span><span class="n">load_clearlandsat</span><span class="p">(</span><span class="n">dc</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span><span class="n">product</span><span class="o">=</span><span class="s1">&#39;fc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Loading ls5 PQ
    Skipping ls5
Loading ls7 PQ
    Loading 0 filtered ls7 timesteps
Loading ls8 PQ
    Loading 15 filtered ls8 timesteps
Combining and sorting ls5, ls7 and ls8 data
</pre></div></div>
</div>
<div class="section" id="Plot-Fractional-Cover-and-Unmixing-Error-Bands">
<h3>Plot Fractional Cover and Unmixing Error Bands<a class="headerlink" href="#Plot-Fractional-Cover-and-Unmixing-Error-Bands" title="Permalink to this headline">¶</a></h3>
<p>Note that Unmixing Error is high over water</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#just a scene we want to plot - this can be done other ways</span>
<span class="n">scene</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#set up our images on a grid using gridspec</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># set up a 2 x 2 grid of 4 images for better presentation</span>

<span class="n">ax1</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ds</span><span class="o">.</span><span class="n">PV</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">scene</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gist_earth_r&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;PV&#39;</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ds</span><span class="o">.</span><span class="n">BS</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">scene</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Oranges&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;BS&#39;</span><span class="p">)</span>

<span class="n">ax3</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ds</span><span class="o">.</span><span class="n">NPV</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">scene</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;copper&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;NPV&#39;</span><span class="p">)</span>

<span class="n">ax4</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ds</span><span class="o">.</span><span class="n">UE</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">scene</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;UE&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_09_Workflows_Fractional_Cover_Percentiles_10_0.png" src="../../_images/notebooks_09_Workflows_Fractional_Cover_Percentiles_10_0.png" />
</div>
</div>
</div>
<div class="section" id="load-the-wofs-feature-layers-(wofls)-within-the-same-query-as-Fractional-cover,-using-'like'">
<h3>load the wofs feature layers (wofls) within the same query as Fractional cover, using ‘like’<a class="headerlink" href="#load-the-wofs-feature-layers-(wofls)-within-the-same-query-as-Fractional-cover,-using-'like'" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#load the wofs feature layers (wofls) within the same query as Fractional cover, using &#39;like&#39;</span>
<span class="n">wofls</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">product</span> <span class="o">=</span> <span class="s1">&#39;wofs_albers&#39;</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="n">ds</span><span class="p">,</span> <span class="n">group_by</span><span class="o">=</span><span class="s1">&#39;solar_day&#39;</span><span class="p">,</span> <span class="n">fuse_func</span><span class="o">=</span><span class="n">wofs_fuser</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Remove-areas-of-water-from-the-Fractional-Cover-dataset">
<h2>Remove areas of water from the Fractional Cover dataset<a class="headerlink" href="#Remove-areas-of-water-from-the-Fractional-Cover-dataset" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wetwofl</span> <span class="o">=</span> <span class="n">masking</span><span class="o">.</span><span class="n">make_mask</span><span class="p">(</span><span class="n">wofls</span><span class="p">,</span> <span class="n">wet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#match WOFL times to our fractional cover times</span>
<span class="n">unwofld</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">time</span> <span class="o">==</span> <span class="n">wetwofl</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>
<span class="c1">#mask out water from fractional cover</span>
<span class="n">unwofld</span> <span class="o">=</span> <span class="n">unwofld</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">wetwofl</span><span class="o">.</span><span class="n">water</span><span class="o">==</span><span class="kc">False</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">del</span> <span class="n">wofls</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">unwofld</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">PV</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[11]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;matplotlib.collections.QuadMesh at 0x7f113e316358&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_09_Workflows_Fractional_Cover_Percentiles_15_1.png" src="../../_images/notebooks_09_Workflows_Fractional_Cover_Percentiles_15_1.png" />
</div>
</div>
</div>
<div class="section" id="Calculate-percentiles-of-Fractional-Cover">
<h2>Calculate percentiles of Fractional Cover<a class="headerlink" href="#Calculate-percentiles-of-Fractional-Cover" title="Permalink to this headline">¶</a></h2>
<p>This can be done on the command line using datacube-stats, but this
notebook demonstrates how to do it in a notebook. The Percentile
function can be used on any dataset, but requires you to create an
object and then ‘compute’ it.</p>
<div class="section" id="Specify-percentiles-to-calculate">
<h3>Specify percentiles to calculate<a class="headerlink" href="#Specify-percentiles-to-calculate" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#edit this list if you want different quantiles/percentiles</span>
<span class="n">percentiles</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Calculate-percentiles">
<h2>Calculate percentiles<a class="headerlink" href="#Calculate-percentiles" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># drop unmixing error and data percentage, which make no sense as quantiles</span>
<span class="n">unwofld</span> <span class="o">=</span><span class="n">unwofld</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;UE&#39;</span><span class="p">,</span> <span class="s1">&#39;data_perc&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">unwofld</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[33]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;xarray.Dataset&gt;
Dimensions:  (time: 15, x: 492, y: 500)
Coordinates:
  * time     (time) datetime64[ns] 2015-01-02T23:50:19.500000 ...
  * y        (y) float64 -3.953e+06 -3.953e+06 -3.953e+06 -3.953e+06 ...
  * x        (x) float64 1.542e+06 1.542e+06 1.542e+06 1.542e+06 1.542e+06 ...
Data variables:
    BS       (time, y, x) float64 18.0 25.0 31.0 28.0 32.0 31.0 27.0 26.0 ...
    PV       (time, y, x) float64 45.0 45.0 46.0 53.0 50.0 48.0 54.0 51.0 ...
    NPV      (time, y, x) float64 36.0 29.0 22.0 19.0 17.0 21.0 19.0 21.0 ...
Attributes:
    crs:      EPSG:3577
</pre></div>
</div>
</div>
<div class="section" id="create-Percentile-object">
<h3>create Percentile object<a class="headerlink" href="#create-Percentile-object" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">FC_percents</span> <span class="o">=</span><span class="n">Percentile</span><span class="p">(</span><span class="n">percentiles</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="compute-percentiles">
<h3>compute percentiles<a class="headerlink" href="#compute-percentiles" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">FC_percentiles</span> <span class="o">=</span> <span class="n">FC_percents</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">unwofld</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="reattach-attributes">
<h3>reattach attributes<a class="headerlink" href="#reattach-attributes" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#reattatch attributes here</span>
<span class="n">FC_percentiles</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="n">unwofld</span><span class="o">.</span><span class="n">attrs</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">FC_percentiles</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[46]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;xarray.Dataset&gt;
Dimensions:     (x: 492, y: 500)
Coordinates:
  * y           (y) float64 -3.953e+06 -3.953e+06 -3.953e+06 -3.953e+06 ...
  * x           (x) float64 1.542e+06 1.542e+06 1.542e+06 1.542e+06 ...
Data variables:
    BS_PC_0     (y, x) float64 14.0 21.0 31.0 28.0 21.0 26.0 23.0 19.0 13.0 ...
    PV_PC_0     (y, x) float64 41.0 37.0 36.0 36.0 31.0 30.0 37.0 39.0 44.0 ...
    NPV_PC_0    (y, x) float64 29.0 19.0 8.0 5.0 8.0 4.0 7.0 15.0 20.0 17.0 ...
    BS_PC_5     (y, x) float64 14.0 24.0 33.0 30.0 27.0 31.0 26.0 24.0 14.0 ...
    PV_PC_5     (y, x) float64 42.0 39.0 39.0 37.0 34.0 33.0 38.0 40.0 45.0 ...
    NPV_PC_5    (y, x) float64 30.0 20.0 8.0 6.0 16.0 4.0 8.0 16.0 23.0 20.0 ...
    BS_PC_20    (y, x) float64 14.0 27.0 38.0 33.0 32.0 36.0 30.0 30.0 16.0 ...
    PV_PC_20    (y, x) float64 42.0 41.0 40.0 40.0 38.0 34.0 43.0 44.0 46.0 ...
    NPV_PC_20   (y, x) float64 33.0 22.0 9.0 12.0 16.0 6.0 9.0 17.0 25.0 ...
    BS_PC_50    (y, x) float64 18.0 30.0 45.0 42.0 36.0 51.0 38.0 32.0 21.0 ...
    PV_PC_50    (y, x) float64 46.0 42.0 42.0 43.0 39.0 40.0 48.0 45.0 48.0 ...
    NPV_PC_50   (y, x) float64 36.0 26.0 12.0 17.0 23.0 12.0 14.0 20.0 29.0 ...
    BS_PC_80    (y, x) float64 20.0 33.0 47.0 43.0 40.0 54.0 46.0 36.0 26.0 ...
    PV_PC_80    (y, x) float64 48.0 45.0 46.0 50.0 48.0 46.0 54.0 51.0 53.0 ...
    NPV_PC_80   (y, x) float64 38.0 29.0 17.0 19.0 27.0 19.0 18.0 23.0 33.0 ...
    BS_PC_95    (y, x) float64 24.0 36.0 50.0 45.0 43.0 62.0 50.0 44.0 29.0 ...
    PV_PC_95    (y, x) float64 50.0 47.0 48.0 51.0 49.0 48.0 55.0 52.0 53.0 ...
    NPV_PC_95   (y, x) float64 38.0 30.0 19.0 22.0 27.0 25.0 20.0 25.0 34.0 ...
    BS_PC_100   (y, x) float64 27.0 43.0 51.0 50.0 53.0 64.0 52.0 44.0 29.0 ...
    PV_PC_100   (y, x) float64 51.0 48.0 49.0 53.0 50.0 49.0 57.0 52.0 54.0 ...
    NPV_PC_100  (y, x) float64 39.0 31.0 22.0 29.0 30.0 27.0 25.0 28.0 39.0 ...
Attributes:
    crs:      EPSG:3577
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Plot-percentiles">
<h2>Plot percentiles<a class="headerlink" href="#Plot-percentiles" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">FC_percentiles</span><span class="o">.</span><span class="n">PV_PC_5</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;YlGn&#39;</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">FC_percentiles</span><span class="o">.</span><span class="n">NPV_PC_5</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;copper&#39;</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">FC_percentiles</span><span class="o">.</span><span class="n">BS_PC_5</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Oranges_r&#39;</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_09_Workflows_Fractional_Cover_Percentiles_30_0.png" src="../../_images/notebooks_09_Workflows_Fractional_Cover_Percentiles_30_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_09_Workflows_Fractional_Cover_Percentiles_30_1.png" src="../../_images/notebooks_09_Workflows_Fractional_Cover_Percentiles_30_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_09_Workflows_Fractional_Cover_Percentiles_30_2.png" src="../../_images/notebooks_09_Workflows_Fractional_Cover_Percentiles_30_2.png" />
</div>
</div>
<div class="section" id="Edit-save-file-path-to-choose-where-to-save-your-output-files">
<h3>Edit save file path to choose where to save your output files<a class="headerlink" href="#Edit-save-file-path-to-choose-where-to-save-your-output-files" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#save files to your home directory (add your outpath here if you want to change it)</span>
<span class="n">savefilepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~/&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Save-Fractional-Cover-percentiles-to-NetCDF">
<h3>Save Fractional Cover percentiles to NetCDF<a class="headerlink" href="#Save-Fractional-Cover-percentiles-to-NetCDF" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>add a unit to the unitless dimension so that it writes to NetCDF</li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">FC_percentiles</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;fractional_cover_percentage_percentile&#39;</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">FC_percentiles</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[52]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;xarray.Dataset&gt;
Dimensions:     (x: 492, y: 500)
Coordinates:
  * y           (y) float64 -3.953e+06 -3.953e+06 -3.953e+06 -3.953e+06 ...
  * x           (x) float64 1.542e+06 1.542e+06 1.542e+06 1.542e+06 ...
Data variables:
    BS_PC_0     (y, x) float64 14.0 21.0 31.0 28.0 21.0 26.0 23.0 19.0 13.0 ...
    PV_PC_0     (y, x) float64 41.0 37.0 36.0 36.0 31.0 30.0 37.0 39.0 44.0 ...
    NPV_PC_0    (y, x) float64 29.0 19.0 8.0 5.0 8.0 4.0 7.0 15.0 20.0 17.0 ...
    BS_PC_5     (y, x) float64 14.0 24.0 33.0 30.0 27.0 31.0 26.0 24.0 14.0 ...
    PV_PC_5     (y, x) float64 42.0 39.0 39.0 37.0 34.0 33.0 38.0 40.0 45.0 ...
    NPV_PC_5    (y, x) float64 30.0 20.0 8.0 6.0 16.0 4.0 8.0 16.0 23.0 20.0 ...
    BS_PC_20    (y, x) float64 14.0 27.0 38.0 33.0 32.0 36.0 30.0 30.0 16.0 ...
    PV_PC_20    (y, x) float64 42.0 41.0 40.0 40.0 38.0 34.0 43.0 44.0 46.0 ...
    NPV_PC_20   (y, x) float64 33.0 22.0 9.0 12.0 16.0 6.0 9.0 17.0 25.0 ...
    BS_PC_50    (y, x) float64 18.0 30.0 45.0 42.0 36.0 51.0 38.0 32.0 21.0 ...
    PV_PC_50    (y, x) float64 46.0 42.0 42.0 43.0 39.0 40.0 48.0 45.0 48.0 ...
    NPV_PC_50   (y, x) float64 36.0 26.0 12.0 17.0 23.0 12.0 14.0 20.0 29.0 ...
    BS_PC_80    (y, x) float64 20.0 33.0 47.0 43.0 40.0 54.0 46.0 36.0 26.0 ...
    PV_PC_80    (y, x) float64 48.0 45.0 46.0 50.0 48.0 46.0 54.0 51.0 53.0 ...
    NPV_PC_80   (y, x) float64 38.0 29.0 17.0 19.0 27.0 19.0 18.0 23.0 33.0 ...
    BS_PC_95    (y, x) float64 24.0 36.0 50.0 45.0 43.0 62.0 50.0 44.0 29.0 ...
    PV_PC_95    (y, x) float64 50.0 47.0 48.0 51.0 49.0 48.0 55.0 52.0 53.0 ...
    NPV_PC_95   (y, x) float64 38.0 30.0 19.0 22.0 27.0 25.0 20.0 25.0 34.0 ...
    BS_PC_100   (y, x) float64 27.0 43.0 51.0 50.0 53.0 64.0 52.0 44.0 29.0 ...
    PV_PC_100   (y, x) float64 51.0 48.0 49.0 53.0 50.0 49.0 57.0 52.0 54.0 ...
    NPV_PC_100  (y, x) float64 39.0 31.0 22.0 29.0 30.0 27.0 25.0 28.0 39.0 ...
Attributes:
    crs:      EPSG:3577
    units:    fractional_cover_percentage_percentile
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="#Write-out-percentiles-to-NetCDF">
<h2>#Write out percentiles to NetCDF<a class="headerlink" href="##Write-out-percentiles-to-NetCDF" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">DEADataHandling</span><span class="o">.</span><span class="n">write_your_netcdf</span><span class="p">(</span><span class="n">FC_percentiles</span><span class="p">,</span> <span class="s1">&#39;FC_percentiles&#39;</span><span class="p">,</span> <span class="n">savefilepath</span><span class="o">+</span><span class="s1">&#39;FC_percentiles.nc&#39;</span><span class="p">,</span> <span class="n">crs</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span>
<span class="c1"># #complain if the file already exists but don&#39;t fail</span>
<span class="k">except</span> <span class="ne">RuntimeError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RuntimeError: </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;wrote to netCDF&#39;</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
wrote to netCDF
</pre></div></div>
</div>
</div>
<div class="section" id="Save-Fractional-Cover-percentiles-to-GeoTiff">
<h2>Save Fractional Cover percentiles to GeoTiff<a class="headerlink" href="#Save-Fractional-Cover-percentiles-to-GeoTiff" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [60]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">FC_percentiles</span>
    <span class="n">write_geotiff</span><span class="p">(</span><span class="n">savefilepath</span><span class="o">+</span><span class="s1">&#39;FC_percentiles.tif&#39;</span><span class="p">,</span> <span class="n">ds</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;wrote to GeoTiff&#39;</span> <span class="p">)</span>
<span class="c1">#         DEADataHandling.write_your_netcdf(FC_quantiles.isel(quantile=quant), &#39;FC_Q&#39;+str(quantiles[quant]), savefilepath+&#39;FC_Q_&#39;+(str(quantiles[quant]).replace(&#39;.&#39;,&#39;_&#39;))+&#39;.nc&#39;, crs = ds.crs)</span>
<span class="k">except</span> <span class="ne">RuntimeError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RuntimeError: </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
wrote to GeoTiff
</pre></div></div>
</div>
</div>
<div class="section" id="References">
<h2>References<a class="headerlink" href="#References" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>GA, 2015. <em>Fractional Cover (FC25) Product Description.</em>
<a class="reference external" href="https://d28rz98at9flks.cloudfront.net/79676/Fractional_Cover_FC25_v1_5.PDF">https://d28rz98at9flks.cloudfront.net/79676/Fractional_Cover_FC25_v1_5.PDF</a></li>
<li>TERN Auscover, 2012. <em>Fractional cover - Landsat, Joint Remote
Sensing Research Program algorithm, Australia coverage.</em> Last
modified by Peter Scarth on 2017/03/24 09:53.
<a class="reference external" href="http://data.auscover.org.au/xwiki/bin/view/Product+pages/Landsat+Fractional+Cover">http://data.auscover.org.au/xwiki/bin/view/Product+pages/Landsat+Fractional+Cover</a></li>
</ol>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../10_Scripts/README.html" class="btn btn-neutral float-right" title="Scripts" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Fractional_Cover_Change_Detection.html" class="btn btn-neutral" title="Fractional Cover: Trend and Variability Analysis" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017-2018, Geoscience Australia.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script type="text/javascript" src="https://unpkg.com/@jupyter-widgets/html-manager@^0.14.0/dist/embed-amd.js"></script>

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>


<!-- Theme Analytics -->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-113800428-1"></script>
<script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());
 
 gtag('config', 'UA-113800428-1');
</script>

    
  


</body>
</html>